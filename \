#include <stdio.h>
#include <stdlib.h>

typedef struct {
	int *data;
	size_t size;
	size_t capacity;
} DynamicArray;

void init_arr(DynamicArray *arr, size_t initCapacity) {
	arr->data = (int*)malloc(initCapacity * sizeof(int));
	if (arr->data == NULL) {
		perror("failed to allocate init memory");
		exit(EXIT_FAILURE);
	}
	arr->size = 0;
	arr->capacity = initCapacity;
	printf("Array initialized with capacity %zu\n", initCapacity);
}

void push_back(DynamicArray *arr, int element) {
	if (arr->size == arr->capacity) {
		size_t newCapacity = arr->capacity * 2;
		printf("Resizing array: %zu -> %zu\n", arr->capacity, newCapacity);

		int *newData = (int *)realloc(arr->data, newCapacity * sizeof(int));
		if (newData == NULL) {
			perror("Failed to reallocate memory");
			exit(EXIT_FAILURE);
		}

		arr->data = newData;
		arr->capacity = newCapacity;
	}

	arr->data[arr->size++] = element;
}

void free_array(DynamicArray *arr) {
	free(arr->data);
	arr->data = NULL;
	arr->size = 0;
	arr->capacity = 0;
	printf("Memory freed.\n");
}

void remove_element(DynamicArray *arr,int *size, int index) {
	if (index < 0 || index >= *size) {
		printf("Invalid index");
		return;
	}
	for (int i = index, i < *size - 1; i++) {
		arr[i] = arr[i + 1];
	}
	(*size)--;
}

int main(int argc, char** argv) { DynamicArray arr; init_arr(&arr, 2);

	push_back(&arr, 10);
	push_back(&arr, 20);
	push_back(&arr, 30);
	push_back(&arr, 40);

	printf("Array elements: ");
	for (size_t i = 0; i < arr.size; i++) {
		printf("%d\n", arr.data[i]);
	}
	printf("\n");
	
	remove_element(&arr, sizeof(&arr), 3);

	for (size_t i = 0; i < arr.size; i++) {
		printf("%d\n", arr.data[i]);
	}
	printf("\n");

	free_array(&arr);
	return 0;
}

